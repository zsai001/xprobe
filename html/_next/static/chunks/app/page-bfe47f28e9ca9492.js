(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4630:function(e,s,t){Promise.resolve().then(t.bind(t,3367))},3367:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return P}});var r=t(7437),a=t(2265),l=t(7071),d=t(9354);let n=l.zt,o=l.fC,c=l.xz,i=a.forwardRef((e,s)=>{let{className:t,sideOffset:a=4,...n}=e;return(0,r.jsx)(l.VY,{ref:s,sideOffset:a,className:(0,d.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})});i.displayName=l.VY.displayName;var x=t(1767),m=t(799),h=e=>{let{value:s,max:t,label:l,byte:n}=e,[o,c]=(0,a.useState)(0);return(0,a.useEffect)(()=>{c(0!==t?s/t*100:0)},[s,t]),(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,r.jsx)("span",{className:"text-xs font-medium text-foreground whitespace-nowrap",children:l}),(0,r.jsx)("span",{className:"text-xs font-medium text-foreground whitespace-nowrap ml-2",children:n?"".concat((0,d.t)(s)," / ").concat((0,d.t)(t)):"".concat(s," / ").concat(t)})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5",children:(0,r.jsx)("div",{className:"h-1.5 rounded-full transition-all duration-500 ease-out ".concat(o<60?"bg-green-500 dark:bg-emerald-400":o<80?"bg-yellow-500 dark:bg-amber-300":"bg-red-500 dark:bg-rose-400"),style:{width:"".concat(o,"%")}})})]})},u=t(7138);let p=e=>{let{label:s,value:t}=e;return(0,r.jsx)(n,{children:(0,r.jsxs)(o,{children:[(0,r.jsx)(c,{children:(0,r.jsxs)("div",{className:"bg-gray-100 text-gray-700 px-1.5 py-0.5 rounded text-[10px] whitespace-nowrap",children:[s,": ","string"==typeof t?t.split(" ")[0]:t]})}),(0,r.jsx)(i,{className:"bg-white border border-gray-200 shadow-md p-2 rounded",children:(0,r.jsxs)("p",{className:"text-gray-800",children:[s,": ",t]})})]})})},j=e=>{let{type:s,supported:t}=e;return(0,r.jsx)(n,{children:(0,r.jsxs)(o,{children:[(0,r.jsx)(c,{children:(0,r.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(t?"bg-green-500":"bg-red-500")})}),(0,r.jsx)(i,{className:"bg-white border border-gray-200 shadow-md p-2 rounded",children:(0,r.jsxs)("p",{className:"text-gray-800",children:[s," ",t?"支持":"不支持"]})})]})})};var f=e=>{let{serverData:s}=e,t=x[s.areaCode];return m[s.osIconUrl],m[s.vendorIconUrl],(0,r.jsx)(u.default,{href:"/server?id=".concat(s.id),className:"block",children:(0,r.jsxs)("div",{className:"bg-card text-card-foreground shadow-md m-1 rounded-lg p-2 border border-border transition-colors duration-200 ease-in-out hover:border-primary relative overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center h-8",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 overflow-hidden",children:[t&&(0,r.jsx)(t,{className:"h-4 w-4 flex-shrink-0 rounded-sm"}),s.osIconUrl&&(0,r.jsx)("img",{src:"/logo/".concat(s.osIconUrl.toLowerCase(),"-icon.svg"),alt:"OS",className:"h-4 w-4 flex-shrink-0"}),s.vendorIconUrl&&(0,r.jsx)("img",{src:"/logo/".concat(s.osIconUrl.toLowerCase(),"-icon.svg"),alt:"Vendor",className:"h-4 w-4 flex-shrink-0"}),(0,r.jsx)("h3",{className:"font-medium text-primary truncate",children:s.serverName})]}),(0,r.jsxs)("div",{className:"flex space-x-1",children:[(0,r.jsx)(j,{type:"IPv4",supported:s.ipv4Supported}),(0,r.jsx)(j,{type:"IPv6",supported:s.ipv6Supported})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 mt-4",children:[(0,r.jsx)(h,{label:"CPU",value:s.cpuUsed,max:s.cpuTotal,byte:!1}),(0,r.jsx)(h,{label:"内存",value:s.memoryUsed,max:s.memoryTotal,byte:!0}),(0,r.jsx)(h,{label:"硬盘",value:s.diskUsed,max:s.diskTotal,byte:!0}),(0,r.jsx)(h,{label:"Swap",value:s.swapUsed,max:s.swapTotal,byte:!0})]}),(0,r.jsxs)("div",{className:"flex justify-between mt-2 text-sm font-medium text-muted-foreground",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"mr-1",children:"↓"}),(0,r.jsxs)("span",{children:[" ",(0,d.t)(s.netDownload)]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"mr-1",children:"↑"}),(0,r.jsx)("span",{children:(0,d.t)(s.netUpload)})]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-1 mt-2 min-h-[1.5rem] overflow-hidden",children:[(0,r.jsx)(p,{label:"TCP",value:s.tcpCount}),(0,r.jsx)(p,{label:"UDP",value:s.udpCount}),(0,r.jsx)(p,{label:"进程",value:s.processCount}),(0,r.jsx)(p,{label:"负载",value:s.load.map(e=>e.toFixed(2)).join(" ")})]})]})})};let g=e=>{let{server:s}=e;return(0,r.jsx)(r.Fragment,{})},v=e=>{let{label:s,value:t}=e;return(0,r.jsx)(n,{children:(0,r.jsxs)(o,{children:[(0,r.jsx)(c,{children:(0,r.jsxs)("div",{className:"bg-gray-100 text-gray-700 px-1 py-0.5 rounded text-[10px] whitespace-nowrap",children:[s,": ","string"==typeof t?t.split(" ")[0]:t]})}),(0,r.jsx)(i,{className:"bg-white border border-gray-200 shadow-md p-2 rounded",children:(0,r.jsxs)("p",{className:"text-gray-800",children:[s,": ",t]})})]})})},b=e=>{let{type:s,supported:t}=e;return(0,r.jsx)(n,{children:(0,r.jsxs)(o,{children:[(0,r.jsx)(c,{children:(0,r.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(t?"bg-green-500":"bg-red-500")})}),(0,r.jsx)(i,{className:"bg-white border border-gray-200 shadow-md p-2 rounded",children:(0,r.jsxs)("p",{className:"text-gray-800",children:[s," ",t?"支持":"不支持"]})})]})})},N=e=>e<1024?"".concat(e," B"):e<1048576?"".concat((e/1024).toFixed(2)," KB"):e<1073741824?"".concat((e/1048576).toFixed(2)," MB"):"".concat((e/1073741824).toFixed(2)," GB");var y=e=>{let{serverData:s}=e;return(0,r.jsxs)("table",{className:"w-full bg-card shadow-md rounded-lg overflow-hidden",children:[(0,r.jsx)("thead",{className:"bg-muted text-muted-foreground",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-3 py-2 text-left w-48",children:"服务器"}),(0,r.jsx)("th",{className:"px-3 py-2 text-left",children:"IP"}),(0,r.jsx)("th",{className:"px-3 py-2 text-left",children:"在线"}),(0,r.jsx)("th",{className:"px-3 py-2 text-left",children:"系统"}),(0,r.jsx)("th",{className:"px-3 py-2 text-left",children:"CPU"}),(0,r.jsx)("th",{className:"px-3 py-2 text-left",children:"内存"}),(0,r.jsx)("th",{className:"px-3 py-2 text-left",children:"硬盘"}),(0,r.jsx)("th",{className:"px-3 py-2 text-left",children:"月流量"}),(0,r.jsx)("th",{className:"px-3 py-2 text-left",children:"总流量"}),(0,r.jsx)("th",{className:"px-3 py-2 text-left",children:"网络"}),(0,r.jsx)("th",{className:"px-3 py-2 text-left",children:"状态"})]})}),(0,r.jsx)("tbody",{className:"text-xs",children:s.map(e=>(0,r.jsxs)("tr",{className:"border-t border-gray-200 hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-3 py-2 w-48",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(g,{server:e}),(0,r.jsx)(n,{children:(0,r.jsxs)(o,{children:[(0,r.jsx)(c,{children:(0,r.jsx)("span",{className:"font-medium text-primary truncate max-w-[120px] inline-block",children:e.serverName})}),(0,r.jsx)(i,{className:"bg-white border border-gray-200 shadow-md p-2 rounded",children:(0,r.jsx)("p",{className:"text-gray-800",children:e.serverName})})]})})]})}),(0,r.jsx)("td",{className:"px-4 py-2",children:(0,r.jsxs)("div",{className:"flex space-x-1",children:[(0,r.jsx)(b,{type:"IPv4",supported:e.ipv4Supported}),(0,r.jsx)(b,{type:"IPv6",supported:e.ipv6Supported})]})}),(0,r.jsx)("td",{className:"px-4 py-2"}),(0,r.jsx)("td",{className:"px-4 py-2",children:e.osName}),(0,r.jsx)("td",{className:"px-4 py-2",children:(0,r.jsx)(h,{label:"CPU",value:e.cpuUsed,max:e.cpuTotal,byte:!1})}),(0,r.jsx)("td",{className:"px-4 py-2",children:(0,r.jsx)(h,{label:"内存",value:e.memoryUsed,max:e.memoryTotal,byte:!0})}),(0,r.jsx)("td",{className:"px-4 py-2",children:(0,r.jsx)(h,{label:"硬盘",value:e.diskUsed,max:e.diskTotal,byte:!0})}),(0,r.jsx)("td",{className:"px-4 py-2",children:N(e.monthlyTraffic)}),(0,r.jsx)("td",{className:"px-4 py-2",children:N(e.totalTraffic)}),(0,r.jsx)("td",{className:"px-4 py-2",children:(0,r.jsxs)("div",{className:"text-xs text-gray-600",children:[(0,r.jsxs)("div",{children:["↓",e.netUpload]}),(0,r.jsxs)("div",{children:["↑",e.netDownload]})]})}),(0,r.jsx)("td",{className:"px-4 py-2",children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:[(0,r.jsx)(v,{label:"TCP",value:e.tcpCount}),(0,r.jsx)(v,{label:"UDP",value:e.udpCount}),(0,r.jsx)(v,{label:"进程",value:e.processCount}),(0,r.jsx)(v,{label:"负载",value:e.load.map(e=>e.toFixed(2)).join(" ")})]})})]},e.id))})]})},w=t(8726),k=t(2800),C=e=>{let{viewMode:s}=e,[t,l]=(0,a.useState)([]),[d,n]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=async()=>{try{let e=await (0,k.SC)("/api/status");Array.isArray(e)?l(e):console.log("server data from api was",e)}catch(e){console.error("Error fetching server status:",e),w.Am.error("Failed to fetch server status")}finally{n(!1)}};e();let s=setInterval(e,1e3);return()=>clearInterval(s)},[]);let o=(0,a.useMemo)(()=>t,[t]);return console.log("the server data was",o),o.length,(0,r.jsx)("div",{className:"bg-muted shadow-inner rounded-lg p-6 border border-border",children:"grid"===s?(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:o&&o.map(e=>(0,r.jsx)(f,{serverData:e},e.id))}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsx)(y,{serverData:o})})})},U=t(8369);function P(){let{viewMode:e}=(0,U.m)();return(0,r.jsx)("div",{className:"container mx-auto max-w-8xl p-8",children:(0,r.jsx)(C,{viewMode:e})})}},8369:function(e,s,t){"use strict";t.d(s,{ViewModeProvider:function(){return n},m:function(){return o}});var r=t(7437),a=t(2265),l=t(6463);let d=(0,a.createContext)(void 0),n=e=>{let{children:s}=e,[t,n]=(0,a.useState)("grid"),o=(0,l.useRouter)(),c=()=>{n(e=>"grid"===e?"list":"grid")};return(0,r.jsx)(d.Provider,{value:{viewMode:t,toggleViewMode:c,toggleViewModeAndNavigate:()=>{c(),"/"!==window.location.pathname&&o.push("/")}},children:s})},o=()=>{let e=(0,a.useContext)(d);if(void 0===e)throw Error("useViewMode must be used within a ViewModeProvider");return e}},2800:function(e,s,t){"use strict";t.d(s,{LP:function(){return a},SC:function(){return n},gy:function(){return d},o4:function(){return l}});let r=(()=>{{let e=window.location.protocol,s=window.location.host;return"".concat(e,"//").concat(s)}})(),a=()=>localStorage.getItem("token"),l=e=>{localStorage.setItem("token",e)},d=()=>{localStorage.removeItem("token")},n=async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t="".concat(r).concat(e),n=a(),o=new Headers(s.headers||{});o.set("Content-Type","application/json"),n&&o.set("Authorization","Bearer ".concat(n));let c=await fetch(t,{...s,headers:o}),i=c.headers.get("X-New-Token");if(i&&l(i),!c.ok){if(401===c.status)throw d(),Error("Session expired. Redirecting to login page.");throw Error("HTTP error! status: ".concat(c.status))}return c.json()}},9354:function(e,s,t){"use strict";t.d(s,{cn:function(){return l},t:function(){return d}});var r=t(4839),a=t(6164);function l(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,a.m6)((0,r.W)(s))}let d=e=>{if(0===e)return"0 B";let s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(0))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][s]}}},function(e){e.O(0,[68,716,335,840,138,738,971,23,744],function(){return e(e.s=4630)}),_N_E=e.O()}]);